webpackJsonp([1],{"6AmN":function(t,e){},BBdy:function(t,e){},BsiQ:function(t,e){},CBMt:function(t,e){},Dx1g:function(t,e){},IKbu:function(t,e){},NGJl:function(t,e){},NHnr:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});s("9mmO"),s("1uLP"),s("52Wt"),s("TFWu"),s("MyjO"),s("qtRy"),s("THnP"),s("K0JP"),s("NfZy"),s("dTzs"),s("+vXH"),s("MsuQ"),s("dSUw"),s("ZDXm"),s("V/H1"),s("CVR+"),s("vmSu"),s("4ZU1"),s("yx1U"),s("SPtU"),s("A52B"),s("PuTd"),s("dm+7"),s("JG34"),s("Rw4K"),s("9mGU"),s("bUY0"),s("mTp7"),s("y9m4"),s("A0n/"),s("VTn2"),s("W/IU"),s("Y5ex"),s("WpPb"),s("+yjc"),s("gPva"),s("C+4B"),s("W4Z6"),s("tJwI"),s("eC2H"),s("n12u"),s("nRs1"),s("jrHM"),s("EuXz"),s("F3sI"),s("bqOW"),s("Racj"),s("tqSY"),s("CvWX"),s("Y1S0"),s("Gh7F"),s("pd+2"),s("MfeA"),s("VjuZ"),s("mJx5"),s("qwQ3"),s("beEN"),s("xMpm"),s("9vc3"),s("WpTh"),s("U6qc"),s("No4x"),s("WgSQ"),s("yuXV"),s("XtiL"),s("A1ng"),s("LG56"),s("Stuz"),s("aJ2J"),s("WiIn"),s("v2lb"),s("7Jvp"),s("lyhN"),s("kBOG"),s("xONB"),s("LlNE"),s("9xIj"),s("m6Yj"),s("wrs0"),s("Lqg1"),s("pWGb"),s("1ip3"),s("N4KQ"),s("Hl+4"),s("MjHD"),s("SRCy"),s("H0mh"),s("gbyG"),s("YVn/"),s("FKfb"),s("zmx7"),s("smQ+"),s("m8F4"),s("v8VU"),s("dich"),s("fx22"),s("SldL"),s("d4tr");var i=s("7+uW"),a=function(t,e){window.sessionStorage.setItem(t,e)},n=function(t){return window.sessionStorage.getItem(t)},r=function(t,e){var s={event_label:e};window.gtag("event",t,s)},o=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";return function(s,i){switch(e){case"des":return i[t]-s[t];case"asc":return s[t]-i[t]}}},c={data:function(){return{}},methods:{cacheQueryData:function(){var t=this.$route.query,e=t.access_token,s=void 0===e?"":e,i=t.lang,n=void 0===i?"":i,r=t.region,o=void 0===r?"":r;s&&a("flipcardAccessToken",s),n&&a("flipcardLang",n),o&&a("flipcardRegion",o)},getCSS:function(){var t,e,s=n("flipcardRegion")||"",i=n("flipcardLang")||"";t="/api/css?region="+s+"&lang="+i,(e=document.createElement("link")).type="text/css",e.rel="stylesheet",e.href=t,document.getElementsByTagName("head")[0].appendChild(e)}},created:function(){this.cacheQueryData(),this.getCSS(),function(t){var e=window.location.search.substr(1);if(e.indexOf(t)>-1){for(var s={},i=e.split("&"),a=0;a<i.length;a++)i[a]=i[a].split("="),s[i[a][0]]=i[a][1];delete s[t];var n=JSON.stringify(s).replace(/[\"\{\}]/g,"").replace(/\:/g,"=").replace(/\,/g,"&"),r="https:"==document.location.protocol?"https://":"http://";window.history.replaceState({},0,r+window.location.host+window.location.pathname+"?"+n)}}("access_token")}},u={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("router-view"),this._v(" "),this._m(0)],1)},staticRenderFns:[function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"wp_pop"},[e("div",{staticClass:"wp_content"},[e("div",{staticClass:"wp_pop_img"}),this._v(" "),e("p",{staticClass:"wp_tips"},[this._v("Please rotate your phone for the best browsing experience")])])])}]};var l=s("VU/8")(c,u,!1,function(t){s("6AmN")},"data-v-645e528c",null).exports,f=s("/ocq"),d=s("4ywN"),h=function(){function t(t,e){for(var s=0;s<e.length;s++){var i=e[s];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}return function(e,s,i){return s&&t(e.prototype,s),i&&t(e,i),e}}();var m=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return h(t,[{key:"maskIn",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(d.a)({targets:t,opacity:1,duration:s,delay:i,easing:"easeInQuad",begin:function(){"function"==typeof e&&e()}})}},{key:"maskOut",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:400;Object(d.a)({targets:t,opacity:0,duration:s,delay:i,easing:"easeInQuad",complete:function(){"function"==typeof e&&e()}})}},{key:"topIn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;Object(d.a)({targets:t,top:["0%","50%"],duration:e})}},{key:"topOut",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600;Object(d.a)({targets:t,top:["50%","0%"],duration:s,easing:"easeInBack",begin:function(){"function"==typeof e&&e()}})}},{key:"heartBeatIn",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:800;Object(d.a)({targets:t,scale:[.6,1],duration:e})}},{key:"heartBeatOut",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;Object(d.a)({targets:t,scale:[1,.6],duration:s,delay:i,easing:"easeInBack",begin:function(){"function"==typeof e&&e()}})}},{key:"swing",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return Object(d.a)({targets:t,rotate:["1.5deg","-1.5deg"],duration:e,delay:s,direction:"alternate",easing:"easeInOutCubic",loop:!0})}},{key:"timeline",value:function(t,e,s){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:50;return d.a.timeline({targets:t,duration:i,autoplay:!1,delay:function(t,e){return 200*e},easing:"easeOutExpo",begin:function(){"function"==typeof e&&e()},complete:function(){"function"==typeof s&&s()}})}},{key:"toast",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:500,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:600;Object(d.a)({targets:t,opacity:[0,1],rotateX:["90deg",0],duration:s,endDelay:i,easing:"spring(1, 100, 10, 10)",complete:function(){"function"==typeof e&&e()}})}},{key:"toastHide",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:300;Object(d.a)({targets:t,rotateX:[0,"90deg"],opacity:[1,0],easing:"linear",duration:s,complete:function(){"function"==typeof e&&e()}})}},{key:"message",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;Object(d.a)({targets:t,translateY:["100%",0],opacity:[0,1],duration:e>500?e:500})}},{key:"rotateY",value:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:600;Object(d.a)({targets:t,rotateY:["180deg",0],duration:s,easing:"easeOutQuad",endDelay:300,complete:function(){"function"==typeof e&&e()}})}}]),t}(),p=new m,v={props:{show:Boolean},data:function(){return{timer:null}},watch:{show:function(t){t&&(this.$bus.toast.isMsg?this.showMessage():this.showToast())}},methods:{showToast:function(){var t=this;p.toast(this.$refs.toast),this.timer=setTimeout(function(){t.hideToast()},2e3)},hideToast:function(){var t=this;if(clearTimeout(this.timer),this.$bus.toast.isMsg)return!1;p.toastHide(this.$refs.toast,function(){t.$bus.toast.show=!1})},showMessage:function(){p.message(this.$refs.toast)}}},_={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"show",rawName:"v-show",value:this.show,expression:"show"}],staticClass:"mask toast",class:this.$bus.toast.isMsg?"msg":"",on:{click:this.hideToast}},[e("div",{ref:"toast",staticClass:"toast-inner"},[e("span",[this._v(this._s(this.$bus.toast.text))])])])},staticRenderFns:[]};var g=s("VU/8")(v,_,!1,function(t){s("IKbu")},"data-v-9f66ff58",null).exports,y={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{directives:[{name:"show",rawName:"v-show",value:this.$bus.loading.show,expression:"$bus.loading.show"}],staticClass:"loading",class:this.$bus.loading.opacity?"opacity":""},[e("svg",{staticClass:"spinner",attrs:{width:"65px",height:"65px",viewBox:"0 0 66 66",xmlns:"http://www.w3.org/2000/svg"}},[e("circle",{staticClass:"path",attrs:{fill:"none","stroke-width":"6","stroke-linecap":"round",cx:"33",cy:"33",r:"30"}})])])},staticRenderFns:[]};var b=s("VU/8")({},y,!1,function(t){s("Dx1g")},null,null).exports,w={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("header",{staticClass:"header"},[s("h1",{staticClass:"header-title"},[s("div",{staticClass:"text"},[t._v(t._s(t.$bus.transify.FLIP_TITLE))]),t._v(" "),s("i",{staticClass:"rule",on:{click:t.showRule}}),t._v(" "),s("i",{staticClass:"history",on:{click:t.showHistory}})]),t._v(" "),s("div",{staticClass:"header-right"},[s("i",{staticClass:"diamond"}),t._v(" "),s("div",{staticClass:"user-info"},[s("span",{staticClass:"gems number-normal"},[t._v(t._s(t.getGem))]),t._v(" "),s("span",{staticClass:"user-id font-normal"},[t._v("ID: "+t._s(t.$bus.uid))])])])])},staticRenderFns:[]};var $=s("VU/8")({computed:{getGem:{get:function(){return this.$bus.gems},set:function(t){this.$bus.gems=t}}},methods:{showHistory:function(){this.$bus.shuffleAnime||this.$bus.flipAnime||this.$bus.getHistory()},showRule:function(){this.$bus.shuffleAnime||this.$bus.flipAnime||(this.$bus.rule.show=!0,this.$bus.addGA("rule","show"))}}},w,!1,function(t){s("PV+N")},"data-v-dad11db6",null).exports,C={props:{imgSrc:String,name:String,nums:Number||String,type:String,light:String,status:Number}},I={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"ff-item",class:[t.type,1===t.status?"grey":""]},[s("div",{staticClass:"ff-item-inner",class:[t.type+"-frame"]},[s("img",{staticClass:"ff-img",attrs:{src:t.imgSrc}}),t._v(" "),1===t.status?s("i",{staticClass:"ff-claimed"}):t._e(),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:t.nums>1,expression:"nums > 1"}],staticClass:"item-nums"},[t._v("X"+t._s(t.nums))]),t._v(" "),t._t("default")],2),t._v(" "),s("div",{staticClass:"ff-name"},[t.name?s("p",{directives:[{name:"marquee",rawName:"v-marquee"}],staticClass:"ff-item-name"},[s("span",[t._v(t._s(t.name))])]):t._e()])])},staticRenderFns:[]};var O=s("VU/8")(C,I,!1,function(t){s("vK3p")},"data-v-93bc5dfa",null).exports,R={props:{type:String,active:Boolean,light:Boolean}},E={render:function(){var t=this,e=t.$createElement;return(t._self._c||e)("button",{staticClass:"button",class:[t.type+"-btn",t.active?"":"dark",t.light?"light":""],on:{click:function(e){return t.$emit("btnEvent")}}},[t._t("default")],2)},staticRenderFns:[]};var T=s("VU/8")(R,E,!1,function(t){s("U9Qj")},"data-v-5741003d",null).exports,S={components:{Item:O,ffButton:T},data:function(){return{showNameIdx:null,timer:null}},computed:{poolStatus:function(){var t=!0,e=!1,s=void 0;try{for(var i,a=this.$bus.rewardPool[Symbol.iterator]();!(t=(i=a.next()).done);t=!0){if(1===i.value.status)return!1}}catch(t){e=!0,s=t}finally{try{!t&&a.return&&a.return()}finally{if(e)throw s}}return!0},refreshStatus:function(){var t=[this.$bus.actInfo.useFreeRefresh,this.$bus.actInfo.allRefresh];return useCostRefresh+t[0]<t[1]},payRefresh:function(){return this.$bus.actInfo.useFreeRefresh>=this.$bus.actInfo.allFreeRefresh},refreshTimes:function(){var t=[this.$bus.actInfo.useFreeRefresh,this.$bus.actInfo.allFreeRefresh],e=t[0],s=t[1];return this.payRefresh?"":s-e+" / "+s}},methods:{showName:function(t){var e=this;if(clearTimeout(this.timer),this.showNameIdx===t)return this.showNameIdx=null,!1;this.showNameIdx=t,this.timer=setTimeout(function(){e.showNameIdx=null},3e3)},handleRefresh:function(){var t=this.$bus.actInfo.refreshCost;if(!this.$bus.shuffleAnime&&!this.$bus.flipAnime)return this.$bus.actInfo.canRefresh?void(this.payRefresh?this.$bus.gems>=t?this.$bus.refreshNotice?this.$bus.confirmDialog={show:!0,type:"refresh"}:this.$bus.refresh(t):this.$bus.handleToast(!0,"FLIP_GEM_NOT_ENOUGH"):this.$bus.refresh(0)):(this.$bus.handleToast(!0,"FLIP_REFRESH_ALL_POOL"),!1)}},mounted:function(){var t=this;this.$nextTick(function(){document.addEventListener("click",function(){clearTimeout(t.timer),t.showNameIdx=null})})}},N={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"pool"},[s("div",{staticClass:"pool-top"},[s("span",{staticClass:"pool-title"},[t._v(t._s(t.$bus.transify.FLIP_CARD_POOL))])]),t._v(" "),s("ul",{staticClass:"pool-content"},[t._l(t.$bus.rewardPool,function(e,i){return[s("Item",{key:e.id,staticClass:"pool-item",attrs:{role:"li",type:1===e.type?"light":"normal",nums:e.num,imgSrc:e.src,status:e.status},nativeOn:{click:function(e){return e.stopPropagation(),t.showName(i)}}},[s("div",{directives:[{name:"show",rawName:"v-show",value:i===t.showNameIdx,expression:"index === showNameIdx"}],staticClass:"pool-item-name",on:{click:function(t){t.stopPropagation()}}},[s("span",[t._v(t._s(e.name))])])])]})],2),t._v(" "),s("div",{staticClass:"pool-refresh"},[s("ff-button",{attrs:{type:"refresh",active:t.$bus.actInfo.canRefresh,light:!t.poolStatus&&t.$bus.actInfo.canRefresh},on:{btnEvent:t.handleRefresh}},[s("div",{staticClass:"refresh-info"},[s("i",{directives:[{name:"show",rawName:"v-show",value:t.$bus.actInfo.canRefresh,expression:"$bus.actInfo.canRefresh"}],staticClass:"refresh-icon"}),t._v(" "),s("div",{staticClass:"refresh-text"},[s("span",{staticClass:"refresh-tip",class:t.$bus.actInfo.canRefresh?"":"done"},[t._v(t._s(t.$bus.actInfo.canRefresh?t.$bus.transify.FLIP_REFRESH:t.$bus.transify.FLIP_REFRESH_DONE))]),t._v(" "),t.$bus.actInfo.canRefresh?s("div",{staticClass:"refresh-cost"},[s("i",{staticClass:"diamond"}),t._v(" "),s("span",{staticClass:"cost-nums",class:t.payRefresh?"":"free-text"},[t._v(t._s(t.payRefresh?t.$bus.actInfo.refreshCost:t.$bus.transify.FLIP_FREE))])]):t._e()])])]),t._v(" "),s("div",{staticClass:"refresh-times"},[t._v("\n      "+t._s(t.refreshTimes)+"\n    ")])],1)])},staticRenderFns:[]};var x=s("VU/8")(S,N,!1,function(t){s("UF6n")},"data-v-7aac41b9",null).exports,A=new m,k={props:{type:Number,src:String,name:String,nums:Number,float:Boolean,status:{type:Number,default:0}},data:function(){return{animeOver:!1}},watch:{status:function(t){var e=this;if(1===t){if(this.$bus.skipAnime)return this.$bus.rewardDialog.show=!0,this.$refs.card.style.transform="rotateY(0)",this.$bus.flipAnime=!1,void(this.animeOver=!0);this.$bus.flipAnime=!0,this.animeOver=!1,A.rotateY(this.$refs.card,function(){e.$bus.rewardDialog.show=!0,e.$bus.flipAnime=!1,e.animeOver=!0})}else this.$refs.card.style.transform="rotateY(180deg)"}},methods:{rotate:function(){if(1===this.status)return this.animeOver=!0,A.rotateY(this.$refs.card),!1}},mounted:function(){this.rotate()}},F={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"card",staticClass:"card",on:{click:function(e){return t.$emit("flipEvent")}}},[s("div",{staticClass:"card-item card-frontend",class:[1===t.type?"light":"",1===t.status?"no-anime":""]},[1===t.status||t.$bus.shuffleAnime?s("div",{staticClass:"card-inner"},[s("div",{staticClass:"card-info"},[s("img",{ref:"cardImg",staticClass:"card-img",class:1!==t.status&&t.float?"":"no-anime",attrs:{src:t.src,alt:t.name}})]),t._v(" "),s("div",{staticClass:"card-item-base"},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.nums>1,expression:"nums > 1"}],staticClass:"card-info-count"},[t._v("X"+t._s(t.nums))])]),t._v(" "),s("div",{staticClass:"card-name"},[t._v(t._s(t.name))]),t._v(" "),1===t.status&&t.animeOver?s("div",{staticClass:"card-mask"},[s("i",{staticClass:"card-mask-icon"})]):t._e()]):t._e()]),t._v(" "),s("div",{staticClass:"card-item card-backend"})])},staticRenderFns:[]};var P=s("VU/8")(k,F,!1,function(t){s("eUJx")},"data-v-316ae68c",null).exports,L=new m,M={components:{Card:P,ffButton:T},props:{shuffle:Boolean,flipAnime:Boolean},data:function(){return{startShuffle:!1,animeTime:null,floatAnime:!1}},computed:{CardList:function(){return this.setFlipCards()},getPrice:function(){var t=this.$bus.rewardPool,e=0,s=!0,i=!1,a=void 0;try{for(var n,r=t[Symbol.iterator]();!(s=(n=r.next()).done);s=!0){1===n.value.status&&e++}}catch(t){i=!0,a=t}finally{try{!s&&r.return&&r.return()}finally{if(i)throw a}}return this.setCount(e),this.$bus.actInfo.spends[e]},getTip:function(){var t=[this.$bus.transify.FLIP_COST,this.$bus.transify.FLIP_SHUFFLE_HINT,this.$bus.transify.FLIP_REFRESH_POOL,this.$bus.transify.FLIP_REFRESH_ALL_POOL,this.$bus.actInfo.canRefresh],e=t[0],s=t[1],i=t[2],a=t[3],n=t[4];return this.shuffle?s:void 0===this.getPrice?n?i:a:e}},watch:{shuffle:function(t){var e=this;t&&(this.startShuffle=!0,this.floatAnime=!0,this.initShuffleAnime(),setTimeout(function(){e.startShuffle=!1,e.playShuffleAnime()},2500))}},methods:{isHasFlip:function(){this.hasFlip||(this.hasFlip=!0)},initShuffleAnime:function(){var t=this;this.animeTime=L.timeline(".flip-card-inner",function(){t.floatAnime=!1},function(){t.$bus.shuffleAnime=!1}),this.animeTime.add({targets:".flip-card",rotateY:[0,"180deg"],duration:600,easing:"easeOutQuad"}).add({targets:".flip-item-1",left:[0,"50%"],translateX:[0,"-55%"],duration:800,easing:"easeOutBack"}).add({targets:".flip-item-3",right:[0,"50%"],translateX:[0,"55%"],duration:800,easing:"easeOutBack"},"-=800").add({targets:".flip-item-2",left:["50%","65%","50%"],zIndex:[0,1,1],duration:600,easing:"easeOutQuad"},"-=300").add({targets:".flip-item-1",left:["50%","65%","50%"],zIndex:[0,2,2],duration:600,easing:"easeOutQuad"},"-=200").add({targets:".flip-item-3",right:["50%","65%","50%"],zIndex:[0,3,3],duration:600,endDelay:300,easing:"easeOutQuad"},"-=100").add({targets:".flip-item-1",left:["50%",0],translateX:["-55%",0],zIndex:0,duration:800,easing:"easeOutBack"}).add({targets:".flip-item-2",zIndex:0,duration:800,easing:"easeOutBack"},"-=800").add({targets:".flip-item-3",right:["50%",0],translateX:["55%",0],zIndex:0,duration:800,easing:"easeOutBack"},"-=800").add({targets:".flip-item-btn",translateY:["50%",0],opacity:[0,1],easing:"easeOutBack"})},playShuffleAnime:function(){this.$bus.skipAnime||this.animeTime.play()},setCount:function(t){this.$bus.nowCount=t+1},setFlipCards:function(){return this.$bus.flipCards.sort(o("index"))},flipCard:function(t){if(this.$bus.flipIdx=t,!this.shuffle&&!this.flipAnime){if(this.$bus.gems<this.getPrice)return this.$bus.handleToast(!0,"FLIP_GEM_NOT_ENOUGH"),!1;this.$bus.nowPrice=this.getPrice,this.$bus.flipNotice?this.$bus.confirmDialog={show:!0,type:"flip"}:this.$bus.flip()}},skipAnime:function(){this.$bus.skipAnime=!this.$bus.skipAnime,localStorage.setItem("flipcard_skip_"+this.$bus.uid,this.$bus.skipAnime),this.$bus.skipAnime&&(this.animeTime&&this.animeTime.seek(1e4),this.$bus.addGA("skipAnime","success"),this.startShuffle=!1,this.$bus.shuffleAnime=!1,this.$bus.firstLoad=!1,localStorage.setItem("flipcard_load_"+this.$bus.uid,!1))}}},U={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"flip-main"},[s("div",{staticClass:"flip-top"},[s("div",{staticClass:"flip-top-text"},[s("span",[t._v(t._s(t.getTip))]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.shuffle,expression:"!shuffle"}],staticClass:"flip-spend"},[t.getPrice?s("span",{staticClass:"flip-cost"},[t._v(t._s(t.getPrice))]):t.$bus.actInfo.canRefresh?s("span",{staticClass:"flip-cost"},[t._v("\n          "+t._s(t.$bus.actInfo.useFreeRefresh>=t.$bus.actInfo.allFreeRefresh?t.$bus.actInfo.refreshCost:t.$bus.transify.FLIP_FREE)+"\n        ")]):t._e(),t._v(" "),s("i",{directives:[{name:"show",rawName:"v-show",value:t.$bus.actInfo.useFreeRefresh>=t.$bus.actInfo.allFreeRefresh&&t.$bus.actInfo.canRefresh||t.getPrice,expression:"($bus.actInfo.useFreeRefresh >= $bus.actInfo.allFreeRefresh && $bus.actInfo.canRefresh)|| getPrice"}],staticClass:"diamond"})])]),t._v(" "),s("div",{staticClass:"flip-skip-anime",on:{click:t.skipAnime}},[s("i",{staticClass:"skip-radio",class:t.$bus.skipAnime?"active":""}),t._v(" "),s("span",{staticClass:"skip-text"},[t._v(t._s(t.$bus.transify.FLIP_SKIP_ANIMATION))])])]),t._v(" "),s("div",{ref:"flip",staticClass:"flip-card-inner"},[t._l(t.CardList,function(e,i){return[s("div",{key:e.index,staticClass:"flip-item",class:"flip-item-"+(i+1)},[s("keep-alive",[s("Card",{staticClass:"flip-card",class:[t.startShuffle?"front-flip":""],attrs:{type:e.type,src:e.src,name:e.name,status:e.status,nums:e.num,float:t.floatAnime}})],1),t._v(" "),s("ff-button",{directives:[{name:"show",rawName:"v-show",value:1!==e.status&&!t.startShuffle,expression:"item.status !== 1 && !startShuffle"}],staticClass:"flip-item-btn",attrs:{type:"flip"},on:{btnEvent:function(e){return t.flipCard(i)}}},[s("span",{staticClass:"flip-btn-text"},[t._v(t._s(t.$bus.transify.FLIP_FLIP))])])],1)]})],2)])},staticRenderFns:[]};var D=s("VU/8")(M,U,!1,function(t){s("BsiQ")},"data-v-daaeb69c",null).exports,H=new m,B={props:{type:String,title:String,show:Boolean},watch:{show:function(t){t?this.showDialog():this.$refs.mask.style.opacity=0}},methods:{showDialog:function(){var t=this;switch(this.type){case"reward":case"confirm":H.maskIn(this.$refs.mask,function(){H.heartBeatIn(t.$refs.dialog)});break;default:H.maskIn(this.$refs.mask,function(){H.topIn(t.$refs.dialog)})}},close:function(){var t=this;switch(this.type){case"reward":case"confirm":H.heartBeatOut(this.$refs.dialog,function(){H.maskOut(t.$refs.mask,function(){t.hideDialog()},200,200)});break;default:H.topOut(this.$refs.dialog,function(){H.maskOut(t.$refs.mask,function(){t.hideDialog()})})}},hideDialog:function(){switch(this.type){case"rule":this.$bus.rule.show=!1;break;case"history":this.$bus.history.show=!1;break;case"reward":this.$bus.rewardDialog.show=!1;break;case"confirm":this.$bus.confirmDialog.show=!1}}}},V={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{ref:"mask",staticClass:"dialog-mask",class:[t.show?"show":"",t.type+"-mask"]},[s("div",{ref:"dialog",staticClass:"dialog"},[s("i",{staticClass:"dialog-close",on:{click:t.close}}),t._v(" "),s("div",{staticClass:"dialog-body",class:t.type+"-dialog"},[t.title?s("h3",{staticClass:"title"},[t._v(t._s(t.title))]):t._e(),t._v(" "),t._t("dialog-content")],2)])])},staticRenderFns:[]};var Y=s("VU/8")(B,V,!1,function(t){s("WVz+")},"data-v-1799351a",null).exports,j={components:{ffButton:T,Dialog:Y},data:function(){return{notice:!0}},computed:{getText:function(){switch(this.$bus.confirmDialog.type||""){case"flip":return this.initNotice(this.$bus.flipNotice),this.replaceText(this.$bus.transify.FLIP_GEM_CONFIRM,"{gem num}",'<span style="font-size: 1.3em; color: #FFDE00; font-weight: 500;">'+this.$bus.nowPrice+"</span>");case"refresh":return this.initNotice(this.$bus.refreshNotice),this.replaceText(this.$bus.transify.FLIP_REFRESH_DBCHECK,"{cost}",'<span style="font-size: 1.3em; color: #FFDE00; font-weight: 500;">'+this.$bus.actInfo.refreshCost+"</span>");default:return""}}},methods:{replaceText:function(t,e,s){return t&&t.indexOf(e)>-1?t.replace(e,""+s):t},handleConfirm:function(){var t=this.$bus.confirmDialog.type;switch(t){case"flip":this.notice||(this.$bus.flipNotice=this.notice,localStorage.setItem("flipcard_"+t+"_"+this.$bus.uid,this.$bus.flipNotice)),this.$bus.flip();break;case"refresh":var e=this.$bus.actInfo.refreshCost;this.notice||(this.$bus.refreshNotice=this.notice,localStorage.setItem("flipcard_"+t+"_"+this.$bus.uid,this.$bus.refreshNotice)),this.$bus.refresh(e)}this.notice=!0,this.$bus.confirmDialog.show=!1,this.$bus.addGA(t+"_close_notice","true")},initNotice:function(t){this.notice=t}}},G={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{ref:"dialog",attrs:{type:"confirm",show:t.$bus.confirmDialog.show},scopedSlots:t._u([{key:"dialog-content",fn:function(){return[s("p",{staticClass:"confirm-tip",domProps:{innerHTML:t._s(t.getText)}}),t._v(" "),s("div",{staticClass:"confirm-notice",on:{click:function(e){t.notice=!t.notice}}},[s("span",{staticClass:"notice-checkbox"},[s("i",{directives:[{name:"show",rawName:"v-show",value:!t.notice,expression:"!notice"}],staticClass:"checkbox-right"})]),t._v(" "),s("span",{staticClass:"notice-text"},[t._v(t._s(t.$bus.transify.POPUP_NO_REMIND))])]),t._v(" "),s("ff-button",{attrs:{type:"confirm"},on:{btnEvent:t.handleConfirm}},[s("span",{staticClass:"confirm-btn-text"},[t._v(t._s(t.$bus.transify.FLIP_CONFIRM))])])]},proxy:!0}])})},staticRenderFns:[]};var W=s("VU/8")(j,G,!1,function(t){s("NGJl")},"data-v-9588f28a",null).exports,q={components:{Dialog:Y}},Q={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{attrs:{type:"rule",show:t.$bus.rule.show,title:t.$bus.transify.COMMON_RULE},scopedSlots:t._u([{key:"dialog-content",fn:function(){return[s("div",{staticClass:"rule-content",domProps:{innerHTML:t._s(t.$bus.rule.content)}})]},proxy:!0}])})},staticRenderFns:[]};var J=s("VU/8")(q,Q,!1,function(t){s("BBdy")},null,null).exports,K={props:{time:String,history:Object},components:{Item:O}},X={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("li",{staticClass:"history-item",class:"refresh"===t.history.type?"refresh-item":""},["flip"===t.history.type?s("div",{staticClass:"item-inner"},[s("Item",{staticClass:"item",attrs:{role:"li",type:1===t.history.pool?"light":"normal",nums:t.history.nums,imgSrc:t.history.src}})],1):s("div",{staticClass:"item-desc"},[t._v(t._s(t.$bus.transify.FLIP_REFRESH_POOL))]),t._v(" "),s("div",{staticClass:"item-name"},[s("p",{directives:[{name:"marquee",rawName:"v-marquee"}]},[s("span",[t._v(t._s(t.history.name))])])]),t._v(" "),s("div",{staticClass:"history-cost"},[s("p",{staticClass:"cost"},[s("i",{staticClass:"diamond"}),t._v(" "),s("span",{staticClass:"gem-nums",class:0===t.history.price?"free":""},[t._v("\n        "+t._s(0===t.history.price?t.$bus.transify.FLIP_FREE:t.history.price)+"\n      ")])])]),t._v(" "),s("div",{staticClass:"history-time"},[t._v(t._s(t.time))])])},staticRenderFns:[]};var z={components:{Dialog:Y,ItemLine:s("VU/8")(K,X,!1,function(t){s("r3fy")},"data-v-d4e203f4",null).exports},data:function(){return{activeIdx:0}},computed:{History:function(){var t=this.$bus.history.data,e=[],s=!0,i=!1,a=void 0;try{for(var n,r=t[Symbol.iterator]();!(s=(n=r.next()).done);s=!0){var c=n.value;e.push({time:c.created_at,price:c.cost,type:c.type,pool:c.item_pool||"",name:c.item_name||"",nums:c.item_num||"",src:c.item_img||""})}}catch(t){i=!0,a=t}finally{try{!s&&r.return&&r.return()}finally{if(i)throw a}}return e.sort(o("time","des"))}},methods:{formateTime:function(t){return function(t){return new Date(1e3*t).toLocaleString()}(t)}}},Z={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{attrs:{type:"history",show:t.$bus.history.show,title:t.$bus.transify.FLIP_HISTORY},scopedSlots:t._u([{key:"dialog-content",fn:function(){return[s("div",{staticClass:"history-content"},[s("ul",{staticClass:"history-list"},[t._l(t.History,function(e){return[s("ItemLine",{key:e.time,staticClass:"history-list-item",attrs:{time:t.formateTime(e.time),history:e}})]})],2)])]},proxy:!0}])})},staticRenderFns:[]};var tt={components:{Item:O,ffButton:T,Dialog:Y},data:function(){return{unique:!1}},computed:{Item:function(){var t=this.$bus.rewardDialog.data||{},e=this.$bus.rewardPool;if(0!==Object.keys(t).length){var s=e.filter(function(e){return e.type===t.pool})[0];return this.setUnique(t.is_token),this.setRewardStatus(t.pool),s}return{nums:0,src:"",name:""}}},methods:{setUnique:function(t){this.unique=0!==t},setRewardStatus:function(t){var e=this;this.$bus.rewardPool.forEach(function(s,i){t===s.type&&(e.$bus.rewardPool[i].status=1)})}}},et={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("Dialog",{ref:"dialog",attrs:{type:"reward",show:t.$bus.rewardDialog.show,title:t.$bus.transify.FLIP_CONGRATULATIONS},scopedSlots:t._u([t.$bus.rewardDialog.show?{key:"dialog-content",fn:function(){return[s("Item",{staticClass:"item",attrs:{type:1===t.Item.type?"light":"normal",nums:t.Item.num,imgSrc:t.Item.src,name:t.Item.name}}),t._v(" "),s("ff-button",{attrs:{type:"confirm"},on:{btnEvent:function(e){return t.$refs.dialog.close()}}},[s("span",{staticClass:"confirm-btn-text"},[t._v(t._s(t.$bus.transify.FLIP_CONFIRM))])]),t._v(" "),s("p",{staticClass:"confirm-tips"},[t._v(t._s(t.unique?t.$bus.transify.UNIQUE_REDEEM_ALREADY_HAVE:t.$bus.transify.COMMON_TIPS_ITEM))])]},proxy:!0}:null],null,!0)})},staticRenderFns:[]};var st={name:"home",data:function(){return{globalConfig:this.$bus.$data}},components:{Loading:b,Toast:g,ffHeader:$,Pool:x,ffMain:D,Confirm:W,Rule:J,History:s("VU/8")(z,Z,!1,function(t){s("rea7")},"data-v-ca5dab36",null).exports,Reward:s("VU/8")(tt,et,!1,function(t){s("CBMt")},"data-v-3faf0b44",null).exports},methods:{initInfo:function(){var t=this,e=n("flipcardAccessToken")||"",s=n("flipcardLang")||"";if(!e)return this.$bus.handleError("TOAST_LOGIN_FAILED");this.$api.info({access_token:e,lang:s}).then(function(e){var s,i,a=e.data;t.$bus.uid=a.player.uid,t.$bus.gems=a.player.gems,t.$bus.transify=a.transify,t.$bus.rule.content=a.common_config.rule,t.$bus.setRewardPool(a.rewards),t.$bus.setActInfo(a.player,a.common_config),a.player.init&&(localStorage.removeItem("flipcard_load_"+t.$bus.uid),localStorage.removeItem("flipcard_flipIdxs_"+t.$bus.uid)),t.initNotice(),document.body.setAttribute("data-lang",a.common_config.lang),s=a.common_config.region,i=t.$bus.uid,window.gtag("config",window.analyticsId,{dimension1:s,page_title:"flipcard",page_path:"/index.html"}),window.gtag("set",{user_id:i})})},initNotice:function(){var t=localStorage.getItem("flipcard_flip_"+this.$bus.uid),e=localStorage.getItem("flipcard_refresh_"+this.$bus.uid),s=localStorage.getItem("flipcard_skip_"+this.$bus.uid),i=localStorage.getItem("flipcard_load_"+this.$bus.uid);this.$bus.flipNotice="false"!==t,this.$bus.refreshNotice="false"!==e,this.$bus.skipAnime="true"===s,this.$bus.firstLoad="false"!==i}},mounted:function(){this.initInfo()}},it={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",{staticClass:"home"},[s("Loading"),t._v(" "),s("Toast",{attrs:{show:t.$bus.toast.show}}),t._v(" "),s("section",{staticClass:"main"},[s("ff-header"),t._v(" "),s("div",{staticClass:"inner"},[s("Pool",{staticClass:"home-pool"}),t._v(" "),s("ff-main",{staticClass:"home-main",class:t.$bus.firstLoading?"hidden":"",attrs:{shuffle:t.$bus.shuffleAnime,flipAnime:t.$bus.flipAnime}})],1)],1),t._v(" "),s("Confirm"),t._v(" "),s("Reward"),t._v(" "),s("Rule"),t._v(" "),s("History")],1)},staticRenderFns:[]};var at=s("VU/8")(st,it,!1,function(t){s("R3ty")},"data-v-3e0cc05d",null).exports;i.a.use(f.a);var nt=new f.a({mode:"history",routes:[{path:"/",name:"home",component:at}]}),rt=s("mtWM"),ot=s.n(rt),ct=new i.a({data:function(){return{uid:null,gems:0,loading:{show:!1,opacity:!1},toast:{show:!1,isMsg:!1,text:""},rule:{show:!1,content:""},history:{show:!1,data:[]},lotteryDialog:{show:!1,notice:!0,price:0},rewardDialog:{show:!1,data:{}},confirmDialog:{show:!1,type:""},firstLoading:!0,refreshNotice:!0,flipNotice:!0,skipAnime:!1,firstLoad:!1,shuffleAnime:!1,flipCards:[],flipAnime:!1,flipIdx:null,hasFlip:!1,actInfo:{useFreeRefresh:0,allFreeRefresh:0,refreshCost:0,spends:[],canRefresh:!0},nowPrice:0,nowCount:1,rewardPool:[],transify:{COMMON_BACK:"back",COMMON_CANCEL:"cancel",COMMON_CONFIRM:"confirm",COMMON_CONTINUE_PURCHASE:"continue to buy",COMMON_HISTORY_DRAW:"",COMMON_HISTORY_PURCHASE:"",COMMON_HISTORY_REDEEM:"",COMMON_NO:"no",COMMON_PURCHASE:"purchase",COMMON_PURCHASED:"purchased",COMMON_QUANTITY_MAX:"max",COMMON_TIPS_ITEM:"the rewards will be sent directly to your vault",COMMON_YES:"Yes",POPUP_NO_REMIND:"Don't remind me again",POPUP_TITLE_REDEEM:"Congratulation! You got",POPUP_TITLE_UNIQUE:"The unique items you owe",UNIQUE_BUY_ALREADY_HAVE:"You already own this item, if you purchase it again, it will be converted to FF tokens.",UNIQUE_BUY_ALREADY_HAVE_PART:"You already owe some of the item(s) you selected. If you purchase again, you will receive FF tokens instead.",UNIQUE_REDEEM_ALREADY_HAVE:"You already own this item, if you receive it again, it will be converted to FF tokens.",TOAST_ERROR_CODE:"unknown error, error code {code}",TOAST_EVENT_CLOSED_AWHILE:"The event is closed temporary",TOAST_EVENT_END:"Event ended",TOAST_EVENT_NOTOPEN:"event hasn't started",TOAST_GEM_NOT_ENOUGH:"insufficient diamonds, please top up and come back again",TOAST_LOGIN_FAILED:"login failed",TOAST_NETWORK_BUSY:"Server busy, please try again later",TOAST_NETWORK_ERROR:"Network connection error, please try again later",TOAST_OPERATE_BUSY:"Too many requests, please try again later",TOAST_PAY_FAILED:"purchase failed",TOAST_SERVER_BUSY:"",TOAST_SERVER_NOTWORK:"service unavailable",TOAST_SERVER_TIMEOUT:"service timeout",TOAST_WRONG_REGION:"This event is not available for your region"}}},methods:{checkGem:function(t){var e=!0;return this.gems<t&&(e=!1),e},addGA:function(t,e){r(t,e)},handleError:function(t){this.handleToast(!0,t,!0),r("msgError",t)},handleToast:function(t,e){var s=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.toast.show=t,this.toast.text=this.transify[e]||this.transify.TOAST_NETWORK_ERROR,this.toast.isMsg=s},handleLoading:function(t,e,s){var i=this;!0===t?(this.loading.opacity=e,this.loading.show=t):setTimeout(function(){i.loading.show=t,i.loading.opacity=e,i.firstLoading=!1,s>0&&!i.skipAnime&&(i.hasFlip?i.shuffleAnime=!1:i.shuffleAnime=i.firstLoad,i.firstLoad&&(i.firstLoad=!1,localStorage.setItem("flipcard_load_"+i.uid,!1)))},s)},randomsort:function(t,e){return Math.random()>.5?-1:1},setRewardPool:function(t){this.rewardPool=[];var e=0,s=!0,i=!1,a=void 0;try{for(var n,r=t[Symbol.iterator]();!(s=(n=r.next()).done);s=!0){var o=n.value;this.rewardPool.push({id:o.item_id,name:o.item_name,type:o.pool,src:o.item_img,status:o.status,num:o.item_num,index:e++}),1===o.status&&(this.hasFlip=!0)}}catch(t){i=!0,a=t}finally{try{!s&&r.return&&r.return()}finally{if(i)throw a}}this.rewardPool=this.rewardPool.sort(this.randomsort),this.initFlipCards()},setActInfo:function(t,e){this.actInfo={useFreeRefresh:t.free_refresh_count,allFreeRefresh:e.free_refresh_count,refreshCost:e.refresh_cost,spends:[e.flip_1_cost,e.flip_2_cost,e.flip_3_cost],canRefresh:t.can_refresh}},getHistory:function(){var t=this;this.$api.history().then(function(e){t.history.data=e.data.history,t.history.show=!0,t.addGA("history","show")})},refresh:function(t){var e=this;this.$api.refresh({gems:t}).then(function(s){var i=s.data.rewards;0===t&&e.$bus.actInfo.useFreeRefresh++,e.$bus.actInfo.canRefresh=s.data.can_refresh,e.gems-=t,e.setRewardPool(i),e.handleToast(!0,"FLIP_TOAST_1"),e.addGA("refresh","success"),e.shuffleAnime=!e.skipAnime,e.flipIdx=null,localStorage.removeItem("flipcard_flipIdxs_"+e.uid)})},flip:function(){var t=this;this.$api.flip({gems:this.nowPrice,count:this.nowCount}).then(function(e){t.gems-=t.nowPrice,t.rewardDialog.data=e.data,t.addGA("flip","success"),t.keepFlipStatus(e.data)})},keepFlipStatus:function(t){var e=JSON.parse(localStorage.getItem("flipcard_flipIdxs_"+this.uid))||{};if(Object.keys(e).length<3){e[t.pool]=this.flipIdx;var s=this.flipCards.findIndex(function(e){return e.type===t.pool});if(this.flipCards[s].status=1,s!==this.flipIdx){var i=[this.flipIdx,this.flipCards[s].index];this.flipCards[s].index=i[0],this.flipCards[this.flipIdx].index=i[1]}}localStorage.setItem("flipcard_flipIdxs_"+this.uid,JSON.stringify(e))},initFlipCards:function(){this.flipCards=JSON.parse(JSON.stringify(this.rewardPool));var t=JSON.parse(localStorage.getItem("flipcard_flipIdxs_"+this.uid))||[],e=[],s=[],i=[0,1,2],a=!0,n=!1,r=void 0;try{for(var o,c=this.flipCards[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var u=o.value,l=t[u.type];void 0===l?s.push(u):(u.index=l,e.push(u),i.splice(i.indexOf(t[u.type]),1))}}catch(t){n=!0,r=t}finally{try{!a&&c.return&&c.return()}finally{if(n)throw r}}i.forEach(function(t,e){s[e].index=t}),this.flipCards=[].concat(e,s)}}}),ut=ot.a.CancelToken,lt={type:"error",code:"TOAST_NETWORK_ERROR"},ft=[],dt="",ht=0,mt=function(){ft.splice(ft.indexOf(dt),1)},pt=ot.a.create({baseURL:"",timeout:2e4,withCredentials:!0}),vt=/.*csrftoken=([^;.]*).*$/,_t=function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;ct.handleLoading(t,e,s)};pt.interceptors.request.use(function(t){return lt.code="TOAST_NETWORK_ERROR",ht=t.delay,t.needLoading&&_t(!0,t.opacity),dt=t.url+t.method,ft.indexOf(dt)>-1?t.cancelToken=new ut(function(t){lt.code="DUPLICATE",t("duplicate request")}):(ft.push(dt),t.headers["X-CSRFToken"]=document.cookie.match(vt)?document.cookie.match(vt)[1]:null),t},function(t){Promise.reject(t)}),pt.interceptors.response.use(function(t){return _t(!1,!1,ht),mt(),"error"===t.data.status?(lt.code=t.data.msg,lt.code.indexOf("FLIP")>-1?ct.handleToast(!0,lt.code,!1):ct.handleError(lt.code),Promise.reject(lt)):t.data},function(t){return t.message&&"duplicate request"===t.message?(lt.code="DUPLICATE",Promise.reject(lt)):(_t(!1,!1,ht),t.message&&t.message.indexOf("timeout")>-1?(lt.code="TIMEOUT",ct.handleError(lt.code),mt(),Promise.reject(lt)):(t.response&&t.response.data.msg&&(lt.code=t.response.data.msg),ct.handleError(lt.code),mt(),Promise.reject(lt)))});var gt=pt,yt={info:function(t){return gt.get("/api/info",{params:t,needLoading:!0,opacity:!1,delay:3e3})},refresh:function(t){return gt.post("/api/refresh",t,{needLoading:!0,opacity:!0})},flip:function(t){return gt.post("/api/flip",t,{needLoading:!0,opacity:!0})},history:function(t){return gt.get("/api/history",{params:t,needLoading:!0,opacity:!0})}};i.a.directive("marquee",function(t){t.classList.contains("marquee")||window.setTimeout(function(){var e=t.offsetWidth,s=t.scrollWidth;if(e&&s&&s>e){var i=t.children[0].cloneNode(!0);t.appendChild(i),t.style.cssText+=";-webkit-animation-duration:"+s/30+"s;animation-duration:"+s/30+"s;--offset:"+(e-2*s-20)+"px",t.classList.add("marquee")}},20)}),i.a.config.productionTip=!1,i.a.prototype.$api=yt,i.a.prototype.$bus=ct,new i.a({el:"#app",router:nt,components:{App:l},template:"<App/>"})},"PV+N":function(t,e){},R3ty:function(t,e){},U9Qj:function(t,e){},UF6n:function(t,e){},"WVz+":function(t,e){},d4tr:function(t,e){},eUJx:function(t,e){},r3fy:function(t,e){},rea7:function(t,e){},vK3p:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.b21b040a509c7f6cb111.js.map